use climate;

insert into province_region_code values(null, "11B00000");
insert into province_region_code values(null, "11D10000");
insert into province_region_code values(null, "11D20000");
insert into province_region_code values(null, "11C20000");
insert into province_region_code values(null, "11C10000");
insert into province_region_code values(null, "11F20000");
insert into province_region_code values(null, "11F10000");
insert into province_region_code values(null, "11H10000");
insert into province_region_code values(null, "11H20000");
insert into province_region_code values(null, "11G00000");

insert into city_region_code values(null, "11B10101", 127, 126, null);
insert into city_region_code values(null, "11B20201", 124, 126, null);
insert into city_region_code values(null, "11B20601", 121, 127, null);
insert into city_region_code values(null, "11B20605", 124, 127, null);
insert into city_region_code values(null, "11B20602", 123, 126, null);
insert into city_region_code values(null, "11B10103", 125, 126, null);
insert into city_region_code values(null, "11B10102", 124, 126, null);
insert into city_region_code values(null, "11B20606", 114, 127, null);
insert into city_region_code values(null, "11B20603", 118, 127, null);
insert into city_region_code values(null, "11B20609", 122, 126, null);
insert into city_region_code values(null, "11B20612", 119, 127, null);
insert into city_region_code values(null, "11B20610", 122, 126, null);
insert into city_region_code values(null, "11B20611", 115, 127, null);
insert into city_region_code values(null, "11B20604", 119, 126, null);
insert into city_region_code values(null, "11B20503", 125, 127, null);
insert into city_region_code values(null, "11B20501", 127, 127, null);
insert into city_region_code values(null, "11B20502", 128, 127, null);
insert into city_region_code values(null, "11B20504", 126, 127, null);
insert into city_region_code values(null, "11B20701", 121, 127, null);
insert into city_region_code values(null, "11B20703", 121, 127, null);
insert into city_region_code values(null, "11B20702", 123, 127, null);
insert into city_region_code values(null, "11B20301", 130, 127, null);
insert into city_region_code values(null, "11B20302", 128, 126, null);
insert into city_region_code values(null, "11B20305", 131, 126, null);
insert into city_region_code values(null, "11B20304", 131, 127, null);
insert into city_region_code values(null, "11B20401", 134, 127, null);
insert into city_region_code values(null, "11B20402", 138, 127, null);
insert into city_region_code values(null, "11B20403", 134, 127, null);
insert into city_region_code values(null, "11B20404", 133, 127, null);
insert into city_region_code values(null, "11B20102", 128, 126, null);
insert into city_region_code values(null, "11B20202", 123, 126, null);
insert into city_region_code values(null, "11B20204", 125, 126, null);
insert into city_region_code values(null, "11B20203", 121, 126, null);
insert into city_region_code values(null, "11H20201", 76, 129, null);
insert into city_region_code values(null, "11H20101", 84, 129, null);
insert into city_region_code values(null, "11H20304", 77, 128, null);
insert into city_region_code values(null, "11H20102", 79, 129, null);
insert into city_region_code values(null, "11H20301", 77, 128, null);
insert into city_region_code values(null, "11H20601", 83, 128, null);
insert into city_region_code values(null, "11H20603", 77, 128, null);
insert into city_region_code values(null, "11H20604", 83, 128, null);
insert into city_region_code values(null, "11H20602", 78, 128, null);
insert into city_region_code values(null, "11H20701", 75, 128, null);
insert into city_region_code values(null, "11H20704", 73, 127, null);
insert into city_region_code values(null, "11H20402", 71, 128, null);
insert into city_region_code values(null, "11H20502", 86, 127, null);
insert into city_region_code values(null, "11H20503", 84, 128, null);
insert into city_region_code values(null, "11H20703", 80, 127, null);
insert into city_region_code values(null, "11H20501", 82, 127, null);
insert into city_region_code values(null, "11H20401", 68, 128, null);
insert into city_region_code values(null, "11H20403", 69, 128, null);
insert into city_region_code values(null, "11H20404", 71, 128, null);
insert into city_region_code values(null, "11H20405", 68, 127, null);
insert into city_region_code values(null, "11H10701", 90, 128, null);
insert into city_region_code values(null, "11H10702", 93, 128, null);
insert into city_region_code values(null, "11H10703", 90, 128, null);
insert into city_region_code values(null, "11H10704", 86, 128, null);
insert into city_region_code values(null, "11H10705", 93, 128, null);
insert into city_region_code values(null, "11H10601", 96, 128, null);
insert into city_region_code values(null, "11H10602", 96, 128, null);
insert into city_region_code values(null, "11H10604", 87, 128, null);
insert into city_region_code values(null, "11H10605", 91, 128, null);
insert into city_region_code values(null, "11H10501", 106, 128, null);
insert into city_region_code values(null, "11H10502", 101, 128, null);
insert into city_region_code values(null, "11H10503", 103, 129, null);
insert into city_region_code values(null, "11H10302", 102, 128, null);
insert into city_region_code values(null, "11H10301", 106, 128, null);
insert into city_region_code values(null, "11H10303", 107, 128, null);
insert into city_region_code values(null, "11H10401", 111, 128, null);
insert into city_region_code values(null, "11H10402", 113, 128, null);
insert into city_region_code values(null, "11H10403", 108, 129, null);
insert into city_region_code values(null, "11H10101", 115, 129, null);
insert into city_region_code values(null, "11H10102", 103, 129, null);
insert into city_region_code values(null, "11H10201", 94, 129, null);
insert into city_region_code values(null, "11H10202", 91, 129, null);
insert into city_region_code values(null, "11F20501", 123, 127, null);
insert into city_region_code values(null, "11F20503", 71, 126, null);
insert into city_region_code values(null, "11F20502", 77, 126, null);
insert into city_region_code values(null, "11F20504", 78, 126, null);
insert into city_region_code values(null, "11F20505", 72, 126, null);
insert into city_region_code values(null, "21F20102", 77, 126, null);
insert into city_region_code values(null, "21F20101", 72, 126, null);
insert into city_region_code values(null, "21F20801", 67, 126, null);
insert into city_region_code values(null, "21F20804", 71, 126, null);
insert into city_region_code values(null, "21F20802", 66, 126, null);
insert into city_region_code values(null, "21F20201", 59, 126, null);
insert into city_region_code values(null, "21F20803", 66, 126, null);
insert into city_region_code values(null, "11F20603", 70, 127, null);
insert into city_region_code values(null, "11F20402", 70, 127, null);
insert into city_region_code values(null, "11F20601", 75, 127, null);
insert into city_region_code values(null, "11F20602", 77, 127, null);
insert into city_region_code values(null, "11F20301", 56, 126, null);
insert into city_region_code values(null, "11F20303", 63, 126, null);
insert into city_region_code values(null, "11F20304", 64, 126, null);
insert into city_region_code values(null, "11F20302", 61, 126, null);
insert into city_region_code values(null, "11F20401", 66, 127, null);
insert into city_region_code values(null, "11F20403", 62, 127, null);
insert into city_region_code values(null, "11F20404", 66, 127, null);
insert into city_region_code values(null, "11F10201", 89, 127, null);
insert into city_region_code values(null, "11F10202", 91, 126, null);
insert into city_region_code values(null, "21F10501", 92, 126, null);
insert into city_region_code values(null, "11F10203", 83, 126, null);
insert into city_region_code values(null, "21F10502", 88, 126, null);
insert into city_region_code values(null, "11F10401", 80, 127, null);
insert into city_region_code values(null, "21F10601", 80, 126, null);
insert into city_region_code values(null, "11F10302", 93, 127, null);
insert into city_region_code values(null, "21F10602", 87, 126, null);
insert into city_region_code values(null, "11F10403", 79, 127, null);
insert into city_region_code values(null, "11F10204", 89, 127, null);
insert into city_region_code values(null, "11F10402", 84, 127, null);
insert into city_region_code values(null, "11F10301", 85, 127, null);
insert into city_region_code values(null, "11F10303", 88, 127, null);
insert into city_region_code values(null, "11C20401", 100, 127, null);
insert into city_region_code values(null, "11C20404", 103, 127, null);
insert into city_region_code values(null, "11C20402", 102, 127, null);
insert into city_region_code values(null, "11C20602", 97, 127, null);
insert into city_region_code values(null, "11C20403", 99, 127, null);
insert into city_region_code values(null, "11C20601", 95, 127, null);
insert into city_region_code values(null, "11C20301", 110, 127, null);
insert into city_region_code values(null, "11C20302", 110, 127, null);
insert into city_region_code values(null, "11C20303", 107, 126, null);
insert into city_region_code values(null, "11C20101", 110, 126, null);
insert into city_region_code values(null, "11C20102", 109, 126, null);
insert into city_region_code values(null, "11C20103", 112, 126, null);
insert into city_region_code values(null, "11C20104", 106, 126, null);
insert into city_region_code values(null, "11C20201", 100, 126, null);
insert into city_region_code values(null, "11C20202", 94, 126, null);
insert into city_region_code values(null, "11C20502", 103, 126, null);
insert into city_region_code values(null, "11C20501", 99, 126, null);
insert into city_region_code values(null, "11C10301", 106, 127, null);
insert into city_region_code values(null, "11C10304", 110, 127, null);
insert into city_region_code values(null, "11C10303", 111, 127, null);
insert into city_region_code values(null, "11C10102", 111, 127, null);
insert into city_region_code values(null, "11C10101", 114, 127, null);
insert into city_region_code values(null, "11C10103", 113, 127, null);
insert into city_region_code values(null, "11C10201", 118, 128, null);
insert into city_region_code values(null, "11C10202", 115, 128, null);
insert into city_region_code values(null, "11C10302", 103, 127, null);
insert into city_region_code values(null, "11C10403", 99, 127, null);
insert into city_region_code values(null, "11C10402", 97, 127, null);
insert into city_region_code values(null, "11D10101", 139, 127, null);
insert into city_region_code values(null, "11D10102", 139, 127, null);
insert into city_region_code values(null, "11D10201", 138, 128, null);
insert into city_region_code values(null, "11D10202", 139, 127, null);
insert into city_region_code values(null, "11D10301", 134, 127, null);
insert into city_region_code values(null, "11D10302", 130, 127, null);
insert into city_region_code values(null, "11D10401", 122, 127, null);
insert into city_region_code values(null, "11D10402", 125, 127, null);
insert into city_region_code values(null, "11D10501", 119, 128, null);
insert into city_region_code values(null, "11D10502", 123, 128, null);
insert into city_region_code values(null, "11D10503", 123, 128, null);
insert into city_region_code values(null, "11D20401", 141, 128, null);
insert into city_region_code values(null, "11D20402", 71, 128, null);
insert into city_region_code values(null, "11D20403", 138, 128, null);
insert into city_region_code values(null, "11D20501", 131, 128, null);
insert into city_region_code values(null, "11D20601", 127, 129, null);
insert into city_region_code values(null, "11D20602", 125, 129, null);
insert into city_region_code values(null, "11D20301", 119, 128, null);
insert into city_region_code values(null, "11G00201", 38, 126, null);
insert into city_region_code values(null, "11G00401", 33, 126, null);
insert into city_region_code values(null, "11G00601", 8, 0, null);
insert into city_region_code values(null, "11B20101", 51, 130, null);
insert into city_region_code values(null, "11H10603", 88, 99, null);
insert into city_region_code values(null, "11F20701", 33, 64, null);
insert into city_region_code values(null, "11C10401", 78, 98, null);
insert into city_region_code values(null, "11D20201", 89, 130, null);
insert into city_region_code values(null, "11G00101", 91, 76, null);
insert into city_region_code values(null, "11G00501", 46, 35, null);
insert into city_region_code values(null, "11G00302", 54, 33, null);
insert into city_region_code values(null, "11G00800", 48, 48, null);

set SQL_SAFE_UPDATES = 0;
update city_region_code as c set c.province_region_code_id = (select id from province_region_code as p where SUBSTRING(p.region_code, 3, 1) = "B" limit 1) where substring(c.region_code, 3, 1) = "B";
update city_region_code as c join province_region_code as p on substring(c.region_code, 3, 2) = substring(p.region_code, 3, 2) set c.province_region_code_id = p.id where substring(c.region_code, 3, 2) = substring(p.region_code, 3, 2);
set SQL_SAFE_UPDATES = 1;